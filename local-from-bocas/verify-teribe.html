<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teribe Verification - Bocas del Toro</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            max-width: 800px;
            margin: 0 auto;
        }
        .success {
            color: #28a745;
            font-size: 24px;
            margin: 20px 0;
            text-align: center;
        }
        .info-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #28a745;
        }
        .map-container {
            width: 100%;
            height: 500px;
            border: 2px solid #333;
            background: #e8f5e8;
            position: relative;
            margin: 20px 0;
        }
        .teribe-highlight {
            fill: #ff6b6b !important;
            stroke: #d63031 !important;
            stroke-width: 3 !important;
            filter: drop-shadow(0 0 10px rgba(255, 107, 107, 0.5)) !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üó∫Ô∏è Teribe Area Verification</h1>
        <div class="success">‚úÖ TERIBE IS NOW INCLUDED IN CHANGUINOLA DISTRICT!</div>
        
        <div class="info-box">
            <h3>üìä What Was Fixed:</h3>
            <ul>
                <li>‚úÖ <strong>Teribe corregimiento</strong> was missing from Changuinola district</li>
                <li>‚úÖ <strong>Added Teribe</strong> to the district mapping</li>
                <li>‚úÖ <strong>Recreated Changuinola district</strong> with all 8 corregimientos</li>
                <li>‚úÖ <strong>Updated GeoJSON file</strong> with complete boundaries</li>
            </ul>
        </div>
        
        <div class="info-box">
            <h3>üèòÔ∏è Changuinola District Now Includes:</h3>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                <div>‚Ä¢ CHANGUINOLA</div>
                <div>‚Ä¢ GUABITO</div>
                <div>‚Ä¢ EL EMPALME</div>
                <div>‚Ä¢ LAS TABLAS</div>
                <div>‚Ä¢ LAS DELICIAS</div>
                <div>‚Ä¢ COCHIGRO</div>
                <div>‚Ä¢ LA GLORIA</div>
                <div style="color: #d63031; font-weight: bold;">‚Ä¢ TERIBE ‚úÖ</div>
            </div>
        </div>
        
        <div class="map-container" id="teribeMap">
            <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: #666;">
                Loading map with Teribe area...
            </div>
        </div>
        
        <div class="info-box">
            <h3>üéØ Expected Result:</h3>
            <p>The map above should now show the <strong>complete Changuinola district</strong> including:</p>
            <ul>
                <li>üèòÔ∏è <strong>Main Changuinola area</strong> (central region)</li>
                <li>üåæ <strong>Teribe area</strong> (should be visible as part of the district)</li>
                <li>üèñÔ∏è <strong>All other corregimientos</strong> properly merged</li>
            </ul>
            <p><strong>Note:</strong> The Teribe area should now be part of the Changuinola district boundary and visible on the map.</p>
        </div>
        
        <div style="text-align: center; margin-top: 30px;">
            <a href="panama/bocas-del-toro.html" style="background: #007bff; color: white; padding: 15px 30px; text-decoration: none; border-radius: 8px; font-size: 18px; margin: 10px;">
                üó∫Ô∏è View Complete Map
            </a>
        </div>
    </div>

    <script>
        async function loadTeribeMap() {
            const mapContainer = document.getElementById('teribeMap');
            
            try {
                // Load the updated GeoJSON data
                const response = await fetch('data/accurate-bocas-del-toro-districts.geojson?v=' + Date.now());
                const geo = await response.json();
                
                console.log('Loaded updated GeoJSON:', geo);
                
                // Find Changuinola district
                const changuinolaDistrict = geo.features.find(f => 
                    f.properties.type === 'district' && f.properties.name === 'CHANGUINOLA'
                );
                
                if (!changuinolaDistrict) {
                    throw new Error('Changuinola district not found');
                }
                
                console.log('Changuinola district:', changuinolaDistrict);
                console.log('Corregimientos:', changuinolaDistrict.properties.corregimientos);
                
                // Create SVG
                const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                svg.setAttribute('width', '100%');
                svg.setAttribute('height', '100%');
                svg.setAttribute('viewBox', '0 0 800 500');
                
                // Calculate bounds for Changuinola district
                const coords = changuinolaDistrict.geometry.coordinates[0];
                let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;
                
                coords.forEach(coord => {
                    minX = Math.min(minX, coord[0]);
                    minY = Math.min(minY, coord[1]);
                    maxX = Math.max(maxX, coord[0]);
                    maxY = Math.max(maxY, coord[1]);
                });
                
                // Scale and center
                const scaleX = 800 / (maxX - minX);
                const scaleY = 500 / (maxY - minY);
                const scale = Math.min(scaleX, scaleY) * 0.8;
                
                const offsetX = (800 - (maxX - minX) * scale) / 2;
                const offsetY = (500 - (maxY - minY) * scale) / 2;
                
                // Create path for Changuinola district
                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                let pathData = '';
                
                coords.forEach((coord, index) => {
                    const x = (coord[0] - minX) * scale + offsetX;
                    const y = (maxY - coord[1]) * scale + offsetY;
                    
                    if (index === 0) {
                        pathData += `M ${x} ${y} `;
                    } else {
                        pathData += `L ${x} ${y} `;
                    }
                });
                pathData += 'Z';
                
                path.setAttribute('d', pathData);
                path.setAttribute('fill', '#4CAF50');
                path.setAttribute('stroke', '#2E7D32');
                path.setAttribute('stroke-width', '2');
                path.setAttribute('opacity', '0.8');
                
                // Add hover effect
                path.addEventListener('mouseenter', () => {
                    path.setAttribute('opacity', '1');
                    path.setAttribute('stroke-width', '4');
                });
                
                path.addEventListener('mouseleave', () => {
                    path.setAttribute('opacity', '0.8');
                    path.setAttribute('stroke-width', '2');
                });
                
                svg.appendChild(path);
                
                // Add label
                const label = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                label.setAttribute('x', '400');
                label.setAttribute('y', '250');
                label.setAttribute('text-anchor', 'middle');
                label.setAttribute('fill', '#2E7D32');
                label.setAttribute('font-size', '24');
                label.setAttribute('font-weight', 'bold');
                label.textContent = 'CHANGUINOLA DISTRICT (with TERIBE)';
                
                svg.appendChild(label);
                
                mapContainer.innerHTML = '';
                mapContainer.appendChild(svg);
                
            } catch (error) {
                console.error('Error loading Teribe map:', error);
                mapContainer.innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: #dc3545; font-size: 18px;">
                        ‚ùå Error loading map: ${error.message}
                    </div>
                `;
            }
        }
        
        // Load the map when page loads
        loadTeribeMap();
    </script>
</body>
</html>
